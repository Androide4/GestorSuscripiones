{% extends 'base.html' %}
{% block title %}Suscripciones{% endblock %}
{% block content %}
<div style="text-align: right; margin: 10px 0;">
    <a href="{% url 'suscripciones:create' %}" class="btn-add">+ A침adir Suscripci칩n</a>
</div>
<div>
    <div class="stats-box">
        <p>Gasto Mensual</p>
        <h3>${{ monthly_spend }}</h3>
    </div>
    <div class="stats-box">
        <p>Gasto Anual</p>
        <h3>${{ yearly_spend }}</h3>
    </div>
    <div class="stats-box">
        <p>Suscripciones Activas</p>
        <h3>{{ active_subs }}</h3>
    </div>
    <div class="stats-box">
        <p>Pagos Pr칩ximos</p>
        <h3>{{ upcoming }}</h3>
    </div>
</div>
<h3>Tus Suscripciones</h3>
<p>Administrando {{ suscripciones.count }} suscripciones</p>
{% for sub in suscripciones %}
<div class="sub-list card">
    <strong>{{ sub.proveedor.nombre }}</strong> - 
    {% if sub.plan %}
        {{ sub.plan.nombre }}
    {% else %}
        Custom
    {% endif %}<br>
    {{ sub.descripcion|default:"Sin descripci칩n" }}<br>
    Precio: 
    {% if sub.plan %}
        {{ sub.plan.precio }} {{ sub.plan.moneda.simbolo }}
    {% else %}
        N/A
    {% endif %} per month<br>
    Vence: {{ sub.fecha_fin }} ({{ sub.fecha_fin|timeuntil }} days)<br>
    <a href="{% url 'suscripciones:update' sub.pk %}" class="btn-edit">Editar</a>
    <a href="{% url 'suscripciones:delete' sub.pk %}" class="btn-delete">Eliminar</a>
</div>
{% empty %}
<p>No subscriptions yet.</p>
{% endfor %}
{% endblock %}